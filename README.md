<details>
  <summary>Table Of Contents</summary>
  
  1. [About The Project](#about-the-project)
      - [Built With](#built-with)
  2. [Loading and Explore Data](#loading-and-explore-data)
  3. [Data Wrangling on multiple tables]
       - [Extract and Create Features from different tables](#extract-and-create-features-from-different-tables)
       - [Concatenate and Join the tables](#concatenate-and-join-the-tables)
  5. [Data Cleansing and Transformation](#data-wrangling-on-multiple-tables)
  6. [Machine Learning Models](#machine-learning-models)
</details>

# About The Project
The purpose of this project is to create a model that will predict whether independent variables such as driver or grandprix circuit affect then chances of a f1 driver being able to win the race In F1, most drivers do finish the race except for a handful of drivers. There are many factors that will result in a driver not being able to finish a race. This may be due to the face that they are unlucky and are always running into issues. This might also be due to the fact that some drivers are not as skillful as others resulting in them colliding with other cars or spinning off the track due to inability to control the car hence not being able to finish the race. Whatever the factor that cause a f1 driver to not be able to finish the race, this dw assignment that Im trying to complete seeks out the independent variables that are capable of affecting the chances of a driver not being able to finish the race.

### Built With
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/98efb040-b4de-465a-bc0d-c8da2c95c4f7" width="200"><br>
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/69448f1e-9924-4c68-9ddd-4bd6d88e7b19" width="200"><br>
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/faef1b95-92a0-42f8-a6b0-2131afd320bb" width="200"><br>
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/8619bf77-7389-499b-8c74-4dff06861fc1" width="200"><br>
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/a2ae5eda-c052-4a8e-b9da-a81f93b77445" width="200"><br>

# Loading and Explore data
To get started on this project, we first had to load the data from the relevant csv files as well as explore the features available in each of these csv files to ensure that the data

In order to explore the data, I decided to plot a correlation matrix for every dataframe to see if there are any correlation between different variables in each dataframe. We can see from the above screenshot that the screenshot is for the results dataframe. From the correlation matrix created for the results dataframe, we can see that status is related to position order with a correlation of 0.43 representing a moderate linear relationship. This makes sense to me as status is the damage or penalty taken by the car which will in turn affect the position order of the car.
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/9d03b544-1673-4a6d-8997-9ef92f8ddda4"><br>
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/e0e7d033-9819-4cb1-95b8-f933bed2d634"><br>
The above correlation matrix is for the pit stops dataframe and we can see that stops variable is related to laps as seen from the correlation matrix as these two variables have a correlation of 0.59 which shows a strong relationship between the two variables. This makes sense to me as with more laps taken by a car, the tyres of the car will tend to get warn down faster and hence more pitstops would be needed. I also plotted a regression plot to see the what is the trend of pitstops against laps.
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/2dcac08c-7649-4b34-bd4c-0d413bb67875"><br>
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/d98ac4a6-3e0f-464d-8369-bea89db1de6b"><br>
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/7687cc87-395f-48d5-a98e-9691867a6511"><br>
Before merging the tables, I actually analyzed each dataframe to see if there are any data that does not seem normal. After checking through, I realised that one of the datasets called races dataset actually had miswritten years. As you can see from the screenshot, in the date column in row 2, the year is written as 12009 instead of 2009 and after checking through the dataframe, there are a few rows that has the same problem. Therefore, I created a for loop to loop through the dataframe to check and replace year values that are miswritten so that it would not cause problems for me afterwards.

# Data Wrangling on Multiple Tables
### Extract and Create features from different tables
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/a3fe0d10-6cbf-478c-98ac-356801d518ce.png"><br>
I decided to extract the year month and quarter values from the date column as well as the year from the date of birth of drivers column from the races dataframe. Since races occur seasonally, by extracting the year, month and quarter values, it might be very useful for the machine learning model as it has the ability to try to improve the accuracy of the model. Afterwards, I dropped the date columns as I feel that it is no longer needed since I have already extracted year month and quarter from the date columns.
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/b91f2b1c-1a04-4652-b7da-d56402211d74.png"><br>
I created a new feature called driver_age. How I created this new feature was by using the previously extracted year from the date of birth column. I created a new column in the dataframe and renamed it as driver_age. In order to obtain the driver age, I used the current year subtracted by the year of the date of birth column to obtain the driver age.
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/1e45ead6-cd71-48d8-8983-a09dd7af035a.png"><br>
For my target variable, I used the feature of position text from the dataframe. Since my prediction problem was to predict who would be able to finish the race, I created a replacement map to replace all the values that are in position text to binary numbers. For those that did not finish the race in the position text, they would be marked by either 'W', 'N', 'F', 'D' or 'R'. These letters indicate that a driver did not finish the race while drivers who finished the race would be marked by a number which was represented by their position when they finish the race. Therefore by using the replacement map, I created a new feature called Finish. 0 would represent that the driver did not finish the race while 1 would represent that a driver would finish the race. This would be my target column later on for my train test split.

### Concatenate, Merge or Join the tables
<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/9f7dd451-1f0b-4e93-aaab-3a7351261ad5.png"><br>
For the merging of tables, I decided to use 7 dataframes for my prediction. As seen from the screenshot above, the first two dataframes that I merged together was the drivers dataframe and the driver standings dataframe. The reason why I merged these two dataframe is because these two dataframe would be able to provide me with valuable information in telling me whether the drivers would finish a race. Some drivers tend to be more careless than others, causing them to not finish the race frequently and in this case, since we are provided with details of drivers and their standings, It would definitely help me in predicting whether a driver would be able to finish a race. The next dataframe that I decided to merge is the results dataframe. The results dataframe contains many information such as a drivers position after a race, the grid position in which the driver will be starting at and etc. From this table I decided to use some columns that would be useful in the prediction of whether a driver would be able to finish a race however, since this dataframe is related to the target variable that I am trying to predict, it would be risky to use variables that are available on post race such as laps as it provides insight to the model on whether the driver had finished the race. The next dataframe that I decided to merge is the constructors dataframe. This dataframe provides information of the different constructors in f1 which would be useful as different constructors manufacture cars of different standards, some are easier to handle than others and the ability of how good a driver can handle a car can also be a factor of predicting whether a driver is able to finish the race without any incidents. Subsequently, the next dataframe that I decided to merge is the status dataframe that defines what all the numbers mean. Afterwards, I merged the races dataframe. The races dataframe provides information of the names of the specific grand prix matched up with the unique primary key of each race as well as also providing information of the date and time of each specific race. The last dataframe that I chose to merge is a dataframe on the pitstops. This dataframe provides information of all the pitstops taking by the car as well as well as the lap at which the driver decides to do a pit stop. This would provide valuable information about the status of the car as a pit stop shortly into the race would indicate a problem with the car and therefore would affect the model on its predictions on whether a driver would be able to finish a race. At the end of merging all the tables, I realised that the number of rows of data has increased too much to a point whereby it takes quite a long time to run the merging of tables cell. Therefore to tackle this problem, I decided to look at which part causes the rows of data to increase drastically and realised that is it the results dataframe that caused the rows of dataframe to increase drastically. In order to tackle this problem, I used the drop duplicates function with the subset of results dataframe being the driverId and from there this code would consider driverId for duplicates and remove them so that the rows of data would not increase exponentially after merging.

<img src="https://github.com/JevTeo123/F1-Machine-Learning-Model/assets/123255675/feded21e-baef-429f-a8e3-10b2e5184330.png"><br>
After merging the tables, I realised that there are some columns that have suffixes X and Y behind them and realised that was because after merging the dataframes, there are columns that are of the same name and therefore to differentiate between these columns, python has automatically added the suffixes X and Y behind them so that they can be differentiated by us. We can see that there are columns such as nationality that has X and Y being added behind them when they are actually representing different things. Therefore, I decided to manually rename every column that has a suffix behind so that I would be able to understand what I am doing later on. For example, the column of nationality actually represents two different things, one was representing driver nationality while the other was representing constructor nationality. Therefore, its important to rename columns that has suffixes to make it clearer for me.

After doing everything and testing my data out with the naive baseline model, I realised that there are some variables that are very highly correlated with the the target variable such as driver position which therefore caused the model to show a 100 percent accuracy. I therefore decided to drop variables such as driver_position and etc so that the model predictions would not be biased just cause of variables like driver_position. I also dropped variables that contain Id behind them such as raceId etc as I think that they are not required.


